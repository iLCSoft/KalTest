#!/bin/csh
#######################
#  create a list of depend files of g++
#$Id: cxxdepends,v 1.2 2005-10-11 00:45:56 fujiik Exp $
#######################

#echo $argv[1]

set uname=`uname`

set cxx="gcc"
set iret=`which $cxx | grep -c /`
if ( $iret > 0 ) then
  if ( $uname != "Darwin" ) then
    set gccvers=`$cxx -v |& head -1 | sed -e 's;[^/]*\(/.*\)/specs.*;\1;'`
    set cppfile=$gccvers/cc1
  else
    set prefix=`$cxx -v |& grep 'prefix=' | sed -e 's;.*--prefix=\([^ ]*\).*;\1;'`
    set osvers=`$cxx -v |& grep Target: | sed -e 's;.*Target: *;;'`
    set gccvers=`$cxx -v |& tail -1 |& sed -e 's;.* \([0-9]*\.[0-9]*\.[0-9]*\) .*;\1;'`
    set cppfile=$prefix/libexec/gcc/$osvers/$gccvers/cc1
  endif
  if ( $uname == "CYGWIN_NT-5.0" ) then
     set cppfile=$gccvers/cc1plus.exe
  endif
  if ( -e $cppfile ) then
  else
    set cppfile=$gccvers/cpp
  endif
  
  set strcmd=`which strings`
  set incdir=`$strcmd $cppfile  | grep include  | grep "/" | uniq `
  foreach i ( $incdir )
    if ( -e $i && $i != "/usr/include" ) then
	echo -n " -I$i" 
    endif
  end
endif


